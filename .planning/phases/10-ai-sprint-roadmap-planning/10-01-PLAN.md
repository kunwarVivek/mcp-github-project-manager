---
phase: 10-ai-sprint-roadmap-planning
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/domain/sprint-planning-types.ts
  - src/domain/roadmap-planning-types.ts
  - src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts
autonomous: true

must_haves:
  truths:
    - "Sprint capacity types include velocity, buffer, team availability"
    - "Risk assessment types support probability, impact, mitigation categories"
    - "Roadmap types include phases, milestones, dependencies, timeline"
    - "Zod schemas validate all AI input/output structures"
  artifacts:
    - path: "src/domain/sprint-planning-types.ts"
      provides: "Sprint AI types (capacity, risk, prioritization)"
      exports: ["SprintCapacity", "SprintRisk", "PrioritizedItem", "SprintSuggestion"]
    - path: "src/domain/roadmap-planning-types.ts"
      provides: "Roadmap AI types (phases, milestones, timeline)"
      exports: ["GeneratedRoadmap", "RoadmapPhase", "RoadmapMilestone"]
    - path: "src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts"
      provides: "Zod schemas for MCP tool validation"
      exports: ["SprintCapacityInputSchema", "RoadmapGenerationInputSchema"]
  key_links:
    - from: "src/domain/sprint-planning-types.ts"
      to: "src/domain/ai-types.ts"
      via: "imports SectionConfidence"
      pattern: "import.*SectionConfidence.*from.*ai-types"
    - from: "src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts"
      to: "zod"
      via: "Zod schema definitions"
      pattern: "z\\.object"
---

<objective>
Define TypeScript interfaces and Zod schemas for AI sprint and roadmap planning.

Purpose: Establish type-safe foundation for sprint capacity planning, backlog prioritization, risk assessment, and roadmap generation services.

Output:
- `src/domain/sprint-planning-types.ts` - Sprint AI domain types
- `src/domain/roadmap-planning-types.ts` - Roadmap AI domain types
- `src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts` - Zod schemas for MCP tools
</objective>

<execution_context>
@/Users/vivek/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vivek/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-ai-sprint-roadmap-planning/10-RESEARCH.md
@src/domain/ai-types.ts
@src/analysis/EstimationCalibrator.ts
@src/analysis/DependencyGraph.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sprint planning domain types</name>
  <files>src/domain/sprint-planning-types.ts</files>
  <action>
Create sprint planning TypeScript interfaces following existing ai-types.ts patterns:

1. **TeamMember interface:**
   - id: string
   - name: string
   - availability: number (0-1 fraction)
   - skills?: string[]

2. **SprintCapacity interface:**
   - totalPoints: number (calculated from velocity)
   - recommendedLoad: number (80% of total for sustainability)
   - teamAvailability: TeamAvailability
   - buffer: { percentage: number; reasoning: string }
   - confidence: SectionConfidence (import from ai-types)

3. **SprintRisk interface:**
   - id: string
   - category: 'scope' | 'dependency' | 'capacity' | 'technical' | 'external'
   - title: string
   - description: string
   - probability: 'high' | 'medium' | 'low'
   - impact: 'high' | 'medium' | 'low'
   - relatedItems: string[]

4. **MitigationSuggestion interface:**
   - riskId: string
   - strategy: 'avoid' | 'mitigate' | 'transfer' | 'accept'
   - action: string
   - effort: 'low' | 'medium' | 'high'
   - effectiveness: number (0-1)

5. **SprintRiskAssessment interface:**
   - overallRisk: 'high' | 'medium' | 'low'
   - riskScore: number (0-100)
   - risks: SprintRisk[]
   - mitigations: MitigationSuggestion[]
   - confidence: SectionConfidence

6. **PrioritizedItem interface:**
   - itemId: string
   - priority: 'critical' | 'high' | 'medium' | 'low'
   - score: number (0-100)
   - factors: { businessValue: number; dependencyScore: number; riskScore: number; effortFit: number }
   - reasoning: string

7. **PrioritizationResult interface:**
   - prioritizedItems: PrioritizedItem[]
   - reasoning: { methodology: string; weightings: object; tradeoffs: string[] }
   - confidence: SectionConfidence

8. **SuggestedItem interface:**
   - itemId: string
   - title: string
   - points: number
   - priority: 'critical' | 'high' | 'medium' | 'low'
   - includeReason: string
   - dependencies: string[]

9. **SprintSuggestion interface:**
   - suggestedItems: SuggestedItem[]
   - totalPoints: number
   - capacityUtilization: number (0-1)
   - reasoning: string
   - risks: SprintRisk[]
   - confidence: SectionConfidence

10. **BacklogItem interface (for input):**
    - id: string
    - title: string
    - description?: string
    - points?: number
    - priority?: 'critical' | 'high' | 'medium' | 'low'
    - labels?: string[]
    - dependencies?: string[]

Export all interfaces. Add JSDoc comments explaining purpose.
  </action>
  <verify>npx tsc --noEmit src/domain/sprint-planning-types.ts</verify>
  <done>Sprint planning types compile without errors and export all interfaces</done>
</task>

<task type="auto">
  <name>Task 2: Create roadmap planning domain types</name>
  <files>src/domain/roadmap-planning-types.ts</files>
  <action>
Create roadmap planning TypeScript interfaces:

1. **RoadmapPhase interface:**
   - id: string
   - name: string
   - description: string
   - objectives: string[]
   - durationWeeks: number
   - startWeek: number
   - endWeek: number
   - milestones: string[] (milestone IDs)

2. **RoadmapMilestone interface:**
   - id: string
   - title: string
   - description: string
   - phaseId: string
   - targetDate: string (ISO date)
   - deliverables: string[]
   - dependencies: string[] (other milestone IDs)
   - confidence: number (0-1)

3. **MilestoneDependency interface:**
   - fromMilestoneId: string
   - toMilestoneId: string
   - type: 'blocks' | 'relates_to'
   - description?: string

4. **RoadmapTimeline interface:**
   - startDate: string
   - endDate: string
   - totalWeeks: number

5. **GeneratedRoadmap interface:**
   - phases: RoadmapPhase[]
   - milestones: RoadmapMilestone[]
   - dependencies: MilestoneDependency[]
   - timeline: RoadmapTimeline
   - confidence: SectionConfidence
   - reasoning?: string

6. **RequirementItem interface (for input):**
   - id?: string
   - title: string
   - description?: string
   - priority?: 'critical' | 'high' | 'medium' | 'low'
   - estimatedPoints?: number
   - category?: string

7. **RoadmapGenerationInput interface:**
   - requirements: string | RequirementItem[]
   - constraints?: {
       timeline?: string (e.g., "6 months", "Q3 2026")
       teamSize?: number
       velocity?: number
       sprintDurationWeeks?: number
     }
   - businessContext?: string

8. **RoadmapVisualizationData interface (for AI-16):**
   - phases: Array<{ id: string; name: string; startWeek: number; endWeek: number; color?: string }>
   - milestones: Array<{ id: string; title: string; week: number; phaseId: string }>
   - dependencies: Array<{ from: string; to: string }>
   - totalWeeks: number

Export all interfaces. Import SectionConfidence from ai-types.
  </action>
  <verify>npx tsc --noEmit src/domain/roadmap-planning-types.ts</verify>
  <done>Roadmap planning types compile without errors and export all interfaces</done>
</task>

<task type="auto">
  <name>Task 3: Create Zod schemas for MCP tool validation</name>
  <files>src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts</files>
  <action>
Create Zod schemas following existing schema patterns (see project-lifecycle-schemas.ts):

**Sprint Schemas:**

1. **TeamMemberInputSchema** - team member input
2. **SprintCapacityInputSchema:**
   - velocity: z.number() or z.literal('auto')
   - sprintDurationDays: z.number()
   - teamMembers: z.array(TeamMemberInputSchema)
   - historicalSprints: z.array(SprintMetricsSchema).optional()

3. **BacklogItemInputSchema:**
   - id: z.string()
   - title: z.string()
   - description: z.string().optional()
   - points: z.number().optional()
   - priority: z.enum(['critical', 'high', 'medium', 'low']).optional()
   - labels: z.array(z.string()).optional()
   - dependencies: z.array(z.string()).optional()

4. **SprintSuggestionInputSchema:**
   - backlogItems: z.array(BacklogItemInputSchema)
   - velocity: z.number()
   - sprintDurationDays: z.number()
   - teamMembers: z.array(TeamMemberInputSchema).optional()
   - businessGoals: z.array(z.string()).optional()
   - riskTolerance: z.enum(['low', 'medium', 'high']).optional()

5. **BacklogPrioritizationInputSchema:**
   - backlogItems: z.array(BacklogItemInputSchema)
   - sprintCapacity: z.number()
   - businessGoals: z.array(z.string()).optional()
   - riskTolerance: z.enum(['low', 'medium', 'high']).optional()

6. **SprintRiskInputSchema:**
   - sprintItems: z.array(BacklogItemInputSchema)
   - capacity: SprintCapacityOutputSchema
   - dependencies: z.array(DependencySchema).optional()

**Roadmap Schemas:**

7. **RequirementInputSchema:**
   - id: z.string().optional()
   - title: z.string()
   - description: z.string().optional()
   - priority: z.enum(['critical', 'high', 'medium', 'low']).optional()
   - estimatedPoints: z.number().optional()
   - category: z.string().optional()

8. **RoadmapConstraintsSchema:**
   - timeline: z.string().optional()
   - teamSize: z.number().optional()
   - velocity: z.number().optional()
   - sprintDurationWeeks: z.number().optional()

9. **RoadmapGenerationInputSchema:**
   - requirements: z.union([z.string(), z.array(RequirementInputSchema)])
   - constraints: RoadmapConstraintsSchema.optional()
   - businessContext: z.string().optional()

**Output Schemas (for MCP tool output validation):**

10. **SprintCapacityOutputSchema:**
    - totalPoints: z.number()
    - recommendedLoad: z.number()
    - buffer: z.object({ percentage: z.number(), reasoning: z.string() })
    - confidence: SectionConfidenceSchema

11. **SprintRiskOutputSchema:**
    - overallRisk: z.enum(['high', 'medium', 'low'])
    - riskScore: z.number()
    - risks: z.array(SprintRiskSchema)
    - mitigations: z.array(MitigationSchema)
    - confidence: SectionConfidenceSchema

12. **PrioritizationOutputSchema:**
    - prioritizedItems: z.array(PrioritizedItemSchema)
    - reasoning: PrioritizationReasoningSchema
    - confidence: SectionConfidenceSchema

13. **SprintSuggestionOutputSchema:**
    - suggestedItems: z.array(SuggestedItemSchema)
    - totalPoints: z.number()
    - capacityUtilization: z.number()
    - reasoning: z.string()
    - risks: z.array(SprintRiskSchema)
    - confidence: SectionConfidenceSchema

14. **RoadmapOutputSchema:**
    - phases: z.array(RoadmapPhaseSchema)
    - milestones: z.array(RoadmapMilestoneSchema)
    - dependencies: z.array(MilestoneDependencySchema)
    - timeline: RoadmapTimelineSchema
    - confidence: SectionConfidenceSchema

15. **RoadmapVisualizationOutputSchema:**
    - phases: z.array(VisualizationPhaseSchema)
    - milestones: z.array(VisualizationMilestoneSchema)
    - dependencies: z.array(DependencyEdgeSchema)
    - totalWeeks: z.number()

Reuse SectionConfidenceSchema pattern from existing ai-task schemas. Export all schemas and inferred types.
  </action>
  <verify>npx tsc --noEmit src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts && grep -c "export const" src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts</verify>
  <done>All Zod schemas compile, at least 15 schemas exported, types inferred correctly</done>
</task>

</tasks>

<verification>
1. TypeScript compiles all new files: `npx tsc --noEmit`
2. No import errors from existing types
3. All interfaces and schemas exported properly
4. Types match research patterns from 10-RESEARCH.md
</verification>

<success_criteria>
1. `src/domain/sprint-planning-types.ts` exists with 10+ interfaces
2. `src/domain/roadmap-planning-types.ts` exists with 8+ interfaces
3. `src/infrastructure/tools/schemas/sprint-roadmap-schemas.ts` exists with 15+ Zod schemas
4. All files compile without TypeScript errors
5. SectionConfidence is properly imported and used
</success_criteria>

<output>
After completion, create `.planning/phases/10-ai-sprint-roadmap-planning/10-01-SUMMARY.md`
</output>
