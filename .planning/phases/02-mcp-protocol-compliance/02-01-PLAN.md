---
phase: 02-mcp-protocol-compliance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - src/index.ts
  - src/infrastructure/tools/ToolValidator.ts
  - src/infrastructure/tools/ToolRegistry.ts
autonomous: true

must_haves:
  truths:
    - "MCP SDK version is 1.25.2 in package.json"
    - "npm install completes without errors"
    - "npm run build completes without errors"
    - "npm test passes with no regressions from SDK upgrade"
  artifacts:
    - path: "package.json"
      provides: "Updated MCP SDK dependency"
      contains: "@modelcontextprotocol/sdk.*1.25"
  key_links:
    - from: "src/index.ts"
      to: "@modelcontextprotocol/sdk/server/index.js"
      via: "import statement"
      pattern: 'from "@modelcontextprotocol/sdk/server/index.js"'
---

<objective>
Upgrade MCP SDK from 1.12.0 to 1.25.2 and fix all import paths for SDK compliance.

Purpose: Foundation for MCP protocol compliance - newer SDK supports annotations and output schemas.
Output: Updated package.json with SDK 1.25.2, all imports using correct paths, passing build and tests.
</objective>

<execution_context>
@/Users/vivek/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vivek/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-mcp-protocol-compliance/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade MCP SDK and add zod-to-json-schema</name>
  <files>package.json, package-lock.json</files>
  <action>
Run npm install to upgrade MCP SDK and add zod-to-json-schema:

```bash
npm install @modelcontextprotocol/sdk@^1.25.2 zod-to-json-schema@^3.23.0
```

After installation, verify package.json shows:
- "@modelcontextprotocol/sdk": "^1.25.2" (or higher)
- "zod-to-json-schema": "^3.23.0" (or higher)

Do NOT change zod version (current ^3.25.32 is compatible).
  </action>
  <verify>
```bash
npm ls @modelcontextprotocol/sdk
npm ls zod-to-json-schema
```
Both should show installed versions.
  </verify>
  <done>package.json has MCP SDK ^1.25.2 and zod-to-json-schema ^3.23.0</done>
</task>

<task type="auto">
  <name>Task 2: Update all imports for new SDK structure</name>
  <files>src/index.ts, src/infrastructure/tools/ToolValidator.ts, src/infrastructure/tools/ToolRegistry.ts</files>
  <action>
The current imports are already using the correct .js extension pattern. Verify and update if needed:

1. In src/index.ts, verify these imports exist (they should already be correct):
```typescript
import { Server } from "@modelcontextprotocol/sdk/server/index.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import {
  CallToolRequestSchema,
  ErrorCode,
  ListToolsRequestSchema,
  McpError,
} from "@modelcontextprotocol/sdk/types.js";
```

2. In src/infrastructure/tools/ToolValidator.ts, verify:
```typescript
import { McpError, ErrorCode } from "@modelcontextprotocol/sdk/types.js";
```

3. Search all .ts files for any imports from @modelcontextprotocol/sdk that don't use .js extension or the new path structure:
```bash
grep -r "@modelcontextprotocol/sdk" src/ --include="*.ts"
```

Fix any imports that don't follow the pattern:
- @modelcontextprotocol/sdk/server/index.js (for Server)
- @modelcontextprotocol/sdk/server/stdio.js (for StdioServerTransport)
- @modelcontextprotocol/sdk/types.js (for types like McpError, ErrorCode)
  </action>
  <verify>
```bash
npm run build
```
Build should complete without import-related errors.
  </verify>
  <done>All MCP SDK imports use new structure with .js extensions</done>
</task>

<task type="auto">
  <name>Task 3: Verify build and tests pass</name>
  <files>N/A (verification only)</files>
  <action>
Run full build and test suite to verify SDK upgrade didn't break anything:

1. Clean build:
```bash
npm run clean && npm run build
```

2. Run tests:
```bash
npm test
```

If tests fail due to SDK changes:
- Check for breaking API changes in SDK 1.25.x
- Review RESEARCH.md for known pitfalls
- Fix any type mismatches or removed exports

Expected: All 342 tests should pass (same as Phase 1 completion).
  </action>
  <verify>
```bash
npm run build && npm test
```
Build exits 0, tests show expected pass count.
  </verify>
  <done>Build succeeds and test suite passes with no regressions</done>
</task>

</tasks>

<verification>
1. `npm ls @modelcontextprotocol/sdk` shows version 1.25.x
2. `npm run build` completes without errors
3. `npm test` passes with same count as before upgrade (342 tests)
4. No TypeScript errors related to SDK imports
</verification>

<success_criteria>
- MCP SDK version is 1.25.2+ in package.json
- zod-to-json-schema is installed for output schema conversion
- All imports use new SDK path structure
- Build and tests pass without regressions
</success_criteria>

<output>
After completion, create `.planning/phases/02-mcp-protocol-compliance/02-01-SUMMARY.md`
</output>
