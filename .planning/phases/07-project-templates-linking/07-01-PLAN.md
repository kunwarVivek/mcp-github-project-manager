---
phase: 07-project-templates-linking
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/infrastructure/tools/schemas/project-template-linking-schemas.ts
  - src/infrastructure/github/repositories/types.ts
autonomous: true

must_haves:
  truths:
    - "Zod schemas exist for all 10 template and linking tools"
    - "Input schemas validate owner/org/project parameters correctly"
    - "Output schemas match expected GraphQL response structures"
    - "Types are exported for use in tool executors"
  artifacts:
    - path: "src/infrastructure/tools/schemas/project-template-linking-schemas.ts"
      provides: "Zod schemas for all template and linking tools"
      exports: ["MarkTemplateInputSchema", "CopyProjectInputSchema", "LinkRepoInputSchema"]
    - path: "src/infrastructure/github/repositories/types.ts"
      provides: "TypeScript interfaces for template and linking operations"
      contains: "TemplateProject"
  key_links:
    - from: "project-template-linking-schemas.ts"
      to: "types.ts"
      via: "type alignment"
      pattern: "import.*types"
---

<objective>
Create Zod schemas for all 10 template and linking MCP tools.

Purpose: Define input validation and output type contracts before implementing tools.
Output: Comprehensive schema file with all input and output schemas for Phase 7 tools.
</objective>

<execution_context>
@/Users/vivek/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vivek/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-project-templates-linking/07-RESEARCH.md
@src/infrastructure/tools/schemas/sub-issue-schemas.ts
@src/infrastructure/github/repositories/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create template operation schemas</name>
  <files>src/infrastructure/tools/schemas/project-template-linking-schemas.ts</files>
  <action>
Create a new schemas file with Zod schemas for template operations (GHAPI-09 to GHAPI-12):

**Input Schemas:**

1. `MarkProjectAsTemplateInputSchema`:
   - projectId: z.string() - Project node ID (PVT_...)

2. `UnmarkProjectAsTemplateInputSchema`:
   - projectId: z.string() - Project node ID (PVT_...)

3. `CopyProjectFromTemplateInputSchema`:
   - projectId: z.string() - Source template project node ID
   - targetOwner: z.string() - Organization login to create project under
   - title: z.string() - New project title
   - includeDraftIssues: z.boolean().optional().default(false)

4. `ListOrganizationTemplatesInputSchema`:
   - org: z.string() - Organization login
   - first: z.number().optional().default(20)
   - after: z.string().optional() - Cursor for pagination

**Output Schemas:**

1. `TemplateProjectOutputSchema`:
   - id: z.string()
   - title: z.string()
   - isTemplate: z.boolean()
   - url: z.string()

2. `CopiedProjectOutputSchema`:
   - id: z.string()
   - title: z.string()
   - number: z.number()
   - url: z.string()
   - createdAt: z.string()

3. `TemplateListOutputSchema`:
   - templates: z.array(TemplateProjectOutputSchema.extend({
       number: z.number(),
       shortDescription: z.string().nullable(),
       createdAt: z.string(),
       updatedAt: z.string()
     }))
   - pageInfo: z.object({ hasNextPage, endCursor })
   - totalCount: z.number()

Export all schemas and inferred types using z.infer.
  </action>
  <verify>TypeScript compiles. `grep -c "z.object" src/infrastructure/tools/schemas/project-template-linking-schemas.ts` shows multiple schemas defined.</verify>
  <done>Template operation schemas (4 input, 3 output) are defined and exported.</done>
</task>

<task type="auto">
  <name>Task 2: Add linking operation schemas</name>
  <files>src/infrastructure/tools/schemas/project-template-linking-schemas.ts</files>
  <action>
Add Zod schemas for linking operations (GHAPI-13 to GHAPI-18) to the same file:

**Input Schemas:**

5. `LinkProjectToRepositoryInputSchema`:
   - projectId: z.string() - Project node ID
   - owner: z.string() - Repository owner
   - repo: z.string() - Repository name

6. `UnlinkProjectFromRepositoryInputSchema`:
   - projectId: z.string() - Project node ID
   - owner: z.string() - Repository owner
   - repo: z.string() - Repository name

7. `LinkProjectToTeamInputSchema`:
   - projectId: z.string() - Project node ID
   - org: z.string() - Organization login
   - teamSlug: z.string() - Team slug (not name)

8. `UnlinkProjectFromTeamInputSchema`:
   - projectId: z.string() - Project node ID
   - org: z.string() - Organization login
   - teamSlug: z.string() - Team slug

9. `ListLinkedRepositoriesInputSchema`:
   - projectId: z.string() - Project node ID
   - first: z.number().optional().default(20)
   - after: z.string().optional()

10. `ListLinkedTeamsInputSchema`:
    - projectId: z.string() - Project node ID
    - first: z.number().optional().default(20)
    - after: z.string().optional()

**Output Schemas:**

4. `LinkedRepositoryOutputSchema`:
   - id: z.string()
   - name: z.string()
   - nameWithOwner: z.string()
   - url: z.string()
   - description: z.string().nullable()

5. `LinkedTeamOutputSchema`:
   - id: z.string()
   - name: z.string()
   - slug: z.string()
   - description: z.string().nullable()

6. `LinkedRepositoriesListOutputSchema`:
   - repositories: z.array(LinkedRepositoryOutputSchema)
   - pageInfo: z.object({ hasNextPage, endCursor })
   - totalCount: z.number()

7. `LinkedTeamsListOutputSchema`:
   - teams: z.array(LinkedTeamOutputSchema)
   - pageInfo: z.object({ hasNextPage, endCursor })
   - totalCount: z.number()

8. `UnlinkOperationOutputSchema`:
   - success: z.boolean()
   - message: z.string()

Export all schemas and inferred types.
  </action>
  <verify>TypeScript compiles. Schema file contains all 10 input schemas and 8 output schemas.</verify>
  <done>All 10 input schemas and 8 output schemas are defined and exported.</done>
</task>

<task type="auto">
  <name>Task 3: Add types to repositories/types.ts</name>
  <files>src/infrastructure/github/repositories/types.ts</files>
  <action>
Add TypeScript interfaces to types.ts for repository layer:

```typescript
// Template operation types
export interface TemplateProject {
  id: string;
  title: string;
  isTemplate: boolean;
  url: string;
  number?: number;
  shortDescription?: string;
  createdAt?: string;
  updatedAt?: string;
}

export interface CopiedProject {
  id: string;
  title: string;
  number: number;
  url: string;
  createdAt: string;
  shortDescription?: string;
}

// Linking operation types
export interface LinkedRepository {
  id: string;
  name: string;
  nameWithOwner: string;
  url: string;
  description?: string;
}

export interface LinkedTeam {
  id: string;
  name: string;
  slug: string;
  description?: string;
}

// List result types with pagination
export interface LinkedRepositoriesResult {
  repositories: LinkedRepository[];
  pageInfo: { hasNextPage: boolean; endCursor: string | null };
  totalCount: number;
}

export interface LinkedTeamsResult {
  teams: LinkedTeam[];
  pageInfo: { hasNextPage: boolean; endCursor: string | null };
  totalCount: number;
}

export interface TemplateListResult {
  templates: TemplateProject[];
  pageInfo: { hasNextPage: boolean; endCursor: string | null };
  totalCount: number;
}
```

Place these after the existing Status Update types.
  </action>
  <verify>TypeScript compiles with `npm run build`. Types are exported from types.ts.</verify>
  <done>Template and linking types defined in types.ts for repository layer.</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with no TypeScript errors
2. `grep -c "Schema" src/infrastructure/tools/schemas/project-template-linking-schemas.ts` shows 18+ schema exports
3. All Zod schemas have corresponding TypeScript types via z.infer
4. types.ts exports all new interfaces
</verification>

<success_criteria>
- 10 input Zod schemas covering all template and linking operations
- 8 output Zod schemas for all response types
- TypeScript interfaces in types.ts for repository layer
- All types properly exported for use in tools and repositories
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-project-templates-linking/07-01-SUMMARY.md`
</output>
